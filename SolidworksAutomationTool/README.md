# SolidworksAutomationTool

# Brief

The Solidworks Automation Tool is a project developed by LASTRO from EPFL. 

This project aims to automate complex and repetitive modelling tasks to build a 3D model of the robotic fiber positioner holder. 

Though there are parameter-based CAD software available, we chose to try automating Solidworks, as it is one of the most widely used CAD modelling software. 

The original idea was to have Python talking to Solidworks and give modelling commands. However, as of July 2023, Solidworks does not officially support Python. Instead, Solidworks has official APIs for C#, VBA, and C++.

We chose C# because of its high performance, high-level syntax and built-in garbage collector. 

# Development Environment Setup

## Pre-requisites

- Visual Studio (the author is using version 2022). Visual studio code with the [Dotnet plugin](https://code.visualstudio.com/docs/languages/dotnet) is also usable for development. However, we suggest using visual studio for a more comprehensive debug and development experience.

- Solidworks, preferrably later than version 2022. 

- The `focal_plane_calc` repository authored by Maxime Rombach. This repo is the parent directory of the automation tool. The Automation tool takes requires the point cloud text files generated by the `focal_plane_calc` repo.

# Current Progress

![image](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/a318a5ba-255b-46d2-bc5c-120a5eb87579)

Can repeatedly create sketches of chamfered, unchamfered modules and pin holes. These sketches are further used for extrusions.

**The main logic of the automation process is**:
- Import two point cloud text files (one for the front point cloud and one for the bottom point cloud). A top point and a corresponding bottom point define an extrusion axis (a 3D line segment in Solidworks). We used to use a Solidworks plugin to for importing text files directly to point cloud objects in Solidworks. However, we now directly create 3D sketch points with the coordinates specified in the text files, bypassing the need to use external plugins.
- Create extrusion axes as construction lines.
- Create 1/6 of a "pizza", aka the "pizza slice".
- Create a bottom plane on bottom of the pizza slice and create 3D sketch points located at the intersections between the bottom plane and the extrusion axes.
- Create 3 "reference sketches" centered at the extrusion axis closest to the origin (in the global frame): a chamfered triangle sketch, a unchamfered/full triangle sketch and a pin hole triangle sketch. 
- Create derived sketches from the 3 "reference sketches" at each extrusion axis, position them correctly, add constraints and extrude these derived sketches.
- Finally extrude the reference sketches.

# Deploying the Automation Tool

Click on the project title `SolidworksAutomationTool`, go to the `Build` tab and click `Publish Selection`

![Screenshot 2023-12-11 154524](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/6d5b3ec0-0d1f-4024-8395-33f1d98b9f2c)

Create a publish profile:
![image](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/e16e340b-5d8e-4f5c-a353-1c9804edb67b)

For publishing to your local disk:

![image](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/d7040488-f5c5-41a0-bb6d-7cd8a2958494)

Choose the location where the deployed program is at and click `Finish`:

![image](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/a04776d9-3e8a-4bc9-a708-c5133b26b85b)

Once the profile is completed, edit the publish settings to tailor to your personal need:
![image](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/0133e44d-9b86-4625-9ff0-4eea852b32b8)

For example, in the popup window, I modified the `Deployment mode` to be self-contained. Visual studio will then add DotNet dependencies to the deployment directory to make the program independent of the installation of DotNet.
I also changed the target runtime to target 64bit Windows computer, since Solidworks runs on Windows only. 
For optimal program performance, change `Configuration` to "Release". The compiler will optimize the program to improve runtime performance. 

![image](https://github.com/MaximeRombach/focal_plane_calc/assets/85515041/87f89055-148b-4b37-8261-c084bebf4189)


# For future developers/maintainers

Please read [Road to Automation](RoadToAutomation.md).  

I cover many of the pitchfalls I encountered during development. Hopefully it will save you some time. 

# TODOs

## On the logic inside the Automation Tool

- [x] Complete the routine to import and place point clouds

- [x] Complete the routine to make extrusion axes

- [x] Complete the routine for making a "full pizza slice"

- [x] Complete the routine for making a full-triangle block

- [x] Complete the routine for making a chamfered-triangle block

- [ ] Reliably position the (full and chamfered) triangles on the "full pizza slice"

- [x] Extrude the modules

- [ ] Repeat the "extruded pizza slice" to make a full focol plane

- [ ] Optionally add a function to determine the orientations of the modules based "sorting the rows"

## On the high-level planning

- [ ] Make GUI to help the user adjust various parameters easily

## On optimizations

- [ ] Make wrapper functions to reduce boilerplat code
- [x] Optionally add a progress bar in the console version of the Automation Tool

## On documentation

- [ ] Generate documentation using Doxygen or docFX. In progress migrating comments to Doxygen style.

- [ ] Add a gif of the whole automation process as part of the readme
